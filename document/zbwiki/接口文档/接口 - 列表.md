# 接口 - 列表
## 概述
列表页面由 3 个子页面组成：关注列表，直播列表，最新列表。

####1.关注列表

关注列表的跳转页面为：`用户主页`，`观看直播`的相关页面。

####2.热门列表
直播列表的跳转页面为：`观看直播`的相关页面。

####3.最新列表
最新列表的跳转页面为：`观看直播`的相关页面。


#####由于涉及到 `观看直播` 、`用户主页`，这些接口将各用一个章节来描述，。因此，本文档一共有 6 个章节，分别为 ：

* 关注列表接口
* 热门列表接口
* 最新列表接口
* 用户主页接口
* 观看直播接口
* 其他接口

```
<<<
success 表示请求成功返回的数据

<<<
error 表示请求失败返回的数据

```

-

## 1 关注列表接口

由于服务器拆分的设定，智播云服务器和客户服务器不会交流用户的大部分数据信息，故获取关注直播列表需要分别向 2 个服务器发送请求：

1.先从客户服务器获取用户关注的人的列表信息。

2.再通过列表信息中的用户唯一标识符，再向直播云服务器获取其是否处于直播状态。

---

### <font style="color:red">1.1 获取用户的关注列表（`ZB_User_Get_List`）</font>
##### 请求参数说明:

###### 请求方式 Post
##### BasicURL：http://custom.zhibocloud.cn/api

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Get_List`|
|type|true|string|列表类型 | type = follow|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|user_id|false|string|指定用户的列表信息||
|uname|false|string|在列表内进行搜索昵称的关键字||
|p|false|int|分页页数||
|limit|false|int|每页显示数量||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "user":{
                "uid":"umc5I1Nzqkv2Ga",
                "usid": "zbuser_7",
                "uname":"小丢丢",
                "sex":"2",
                "intro":"",
                "cover":{

                },
                "location":"",
                "avatar":{

                },
                "is_verified":0,
                "gold":0,
                "follow_count":0,
                "fans_count":1,
                "zan_count":0,
                "live_time":0
            },
            "is_follow":1
        }
    ]
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|   is_follow      |        int            |       是否已经关注            |1:已关注  0:未关注|
|{user}|
|       uid         |       string          |       加密后的用户UID          |  |
|       usid        |       string          |       储存在直播服务器端的用户唯一标识||
|       uname       |       string          |       用户昵称                 ||
|       sex         |       int             |       性别                     |1:男 2:女|
|       intro       |       string          |       简介                     ||
|       location    |       string          |       用户填写的地址信息       ||
|   cover          |       object          |       用户个人主页封面图地址             ||
|   avatar          |       object          |       用户头像地址             ||
|   is_verified     |       int             |       是否已经认证           |0:未认证 1:已认证 2:审核中|
|   gold            |       int             |       金币数                   ||
|   follow_count    |       int             |       关注数                   ||
|   fans_count      |       int             |       粉丝数                   ||
|   zan_count       |       int             |       获得的赞总数             ||
|   live_time       |       int             |       直播时长             |单位:分钟|

### 1.2 获取用户直播状态

### 获取随机推荐直播间列表(`ZBCloud_Get_Stream_Status`)

##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识,多个请以逗号分割||
★  参数中的usid是用户在直播服务的唯一标识

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "usid":"zbuser_6",
            "status":1,
            "info":{
                "stream":{
                    "id":"z1.zhibo_test.zhibocloud_uid_1",
                    "title":"小孙孙-在直播",
                    "location":"四川省成都市",
                    "icon":{
                        "0":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/1676408d0fd7659e08c7539444a389ce.jpg",
                        "1":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/thumb/1676408d0fd7659e08c7539444a389ce_t.jpg",
                        "更多":"更多比例的图片"
                    },
                    "online_count":0
                },
                "im":{
                    "cid":10873,
                    "im_uid":20001
                },
                "user":{
                    "usid":"zbuser_6"
                }
            }
        },
        {
            "usid":"zbuser_13",
            "status":0,
            "info":{

            }
        }
    ]
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       usid        |       string          |  用户唯一标识          |  |
|       status      |       int             |  1:正在直播  0:未直播          |  |
|       info        |       object          |  直播的详细信息 | 仅主播正在直播的时候有数据|
|{stream}|
|       id          |       string          |       直播间ID          |  |
|       title       |       string          |       直播间标题          |  |
|       location    |       string          |       主播所在地址          |  |
|       online_count|       int             |       在线人数          |  |
|       icon        |       object          |       直播间封面图          |  |
|{im}|
|cid    |  int        |       会话ID          |代表聊天室ID                |
|im_uid   |  int        |       会话创建者的im_uid        ||
|{user}|
|       usid        |       string          |       用户唯一标识          |  |

--
## 2 热门列表接口

### 获取直播间列表(`ZBCloud_Get_Live_List`)
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|order|true|string|排序方式/数据分类|online：热门列表   airtime：最新列表|
|p|false|int|分页页数||
|limit|false|int|每页显示数量||
|location|false|string|地址|筛选的条件1,参数值已配置接口获取到的为准|
|sex|false|int|性别|筛选的条件2,参数值已配置接口获取到的为准|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "stream":{
                "id":"z1.zhibo_test.zhibocloud_uid_4",
                "title":"我在直播",
                "location":"",
                "icon":{
                    "0":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/1676408d0fd7659e08c7539444a389ce.jpg",
                    "1":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/thumb/1676408d0fd7659e08c7539444a389ce_t.jpg",
                    "更多":"更多比例的图片"
                },
                "online_count":5
            },
            "im":{
                "cid":10087,
                "im_uid":20004
            },
            "user":{
                "usid":"zbuser_7"
            }
        }
    ]
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|{stream}|
|       id          |       string          |       直播间ID          |  |
|       title       |       string          |       直播间标题          |  |
|       location    |       string          |       主播所在地址          |  |
|       online_count|       int             |       在线人数          |  |
|       icon        |       object          |       直播间封面图          |  |
|{im}|
|cid    |  int        |       会话ID          |代表聊天室ID                |
|im_uid   |  int        |       会话创建者的im_uid        ||
|{user}|
|       usid        |       string          |       用户唯一标识          |  |
--
## 3 最新列表接口

参见 `2 热门列表接口`

--
## 4 用户主页接口

### 4.1 获取用户的回放列表(`ZBCloud_Get_Video_List`)
##### 请求参数说明:

* 如果指定了usid参数,此时的order参数失效,只获取usid对应用户的视频
* 筛选条件参数是多个,此处的sex order time参数只是举例,具体的参数名称以获取配置接口的值为准

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|order|false|string|排序/分类|all:所有视频,不包含自己的视频  own:当前登陆用户自己的|
|p|false|int|分页页数||
|limit|false|int|每页显示数量||
|usid|false|string|获取指定用户的视频列表,该usid由第三方指定|如果指定了usid参数,此时的order参数失效,只获取usid对应用户的视频|
|sex|false|int|性别|筛选的条件1|
|time|false|string|时间|筛选的条件2|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "video":{
                "vid":"iujVCZ8uyBTwD=Gq54",
                "video_title":"的视频",
                "video_start":"1468921970",
                "video_end":"1468922255",
                "video_icon":{

                },
                "video_location":"四川省成都市",
                "replay_count":"0",
                "video_ext":"mp4",
                "time":285,
                "time_info":"4分钟45秒"
            },
            "user":{
                "usid":""
            }
        },
    ]
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|   vid          |       string          |       加密后的视频ID          |  |
|   video_title  |       string          |       视频标题                ||
|   video_start  |       string          |       视频开始时间            |时间戳|
|   video_end    |       string          |       视频结束时间            |时间戳|
|   video_icon   |       object          |       视频封面图              |url地址集合|
|  replay_count  |       int             |       播放次数                ||
|   video_ext    |       string          |       视频格式                |如,mp4|
|   time         |       stirng          |       视频时长                |单位:秒|
|   time_info         |       stirng          |       视频时长信息                |如,3小时25分钟50秒|
|{user}|
|   usid          |       string          |       用户唯一标识,由第三方提供         ||
---
### 4.2 获取回放视频的播放地址(`ZBCloud_Get_Video_Url`)
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vid|true|string|视频vid||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "playurls":{
            "http":"http://pili-media.zhibocloud.cn/recordings/z1.zhibo_test.zhibo_16/zhibo_e6c1e199b6197fd88b16f2381a64512b.mp4"
        }
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}


```

---
### <font style="color:red">4.3 关注操作(`ZB_User_Follow`)</font>

##### 请求参数说明:

###### 请求方式 Post
##### BasicURL：http://custom.zhibocloud.cn/api

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Follow`|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|user_id|true|string|指定用户的列表信息||
|action|false|int|操作| 1:关注 2:取消关注 3:查询是否关注 default:3|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "is_follow":1
    }
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       is_follow         |       int          |       是否已经关注          | 1:关注成功/已关注 0:未关注  |
---
###4.4 <font style = 'color:red'>获取用户信息(`ZB_User_Get_Info`)</font>

##### 请求参数说明:
★  如果获取多个用户的信息,使用英文逗号分割user_id参数

★  如果user参数为空或不传,会返回当前登陆用户的信息

★  为了数据统一,获取单个用户信息,也会以二维数组数据传递


| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Get_Info `|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|usid|true|string|用户唯一标识||
| field |false|string|获取指定的字段,多个以逗号分割 | |


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "uid":"iyn=0t5P2wUwmq",
            "uname":"小孙test",
            "sex":1,
            "intro":"这是一个牛逼的人",
            "cover":{

            },
            "location":"",
            "avatar":{

            },
            "is_verified":0,
            "usid":"zbuser_7",
            "gold":364,
            "follow_count":0,
            "fans_count":1,
            "zan_count":8803,
             "is_follow": 1
        }
    ]
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       uid         |       string          |       加密后的用户UID          |  |
|       usid        |       string          |       储存在直播服务器端的用户唯一标识||
|       uname       |       string          |       用户昵称                 ||
|       sex         |       int             |       性别                     |1:男 2:女|
|       intro       |       string          |       简介                     ||
|       location    |       string          |       用户填写的地址信息       ||
|   cover            |       object          |       用户个人主页封面图地址             ||
|   avatar          |       object          |       用户头像地址             ||
|   is_verified     |       int             |       是否已经认证           |0:未认证 1:已认证 2:审核中|
|   gold            |       int             |       金币数                   ||
|   follow_count    |       int             |       关注数                   ||
|   fans_count      |       int             |       粉丝数                   ||
|   zan_count      |       int             |       收到的赞数                   ||
|   is_follow      |       int             |       是否关注                   ||


--
## 5 观看直播接口

### 概述
在观看直播页面中，除了观看直播的功能外，还包含点赞、聊天、礼物、投票的功能，本章节也将从上述 5 个方面在阐述。

---
### 5.1 观看直播

#### 5.1.1 获取观看直播地址(`ZBCloud_Get_Playurl`)
##### 请求参数说明:

1. stream_id和usid至少有一个参数有效
2. 若两参数均有效,返回结果以usid为条件所得
3. 若两参数均无效,将返回推荐主播

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|stream_id|true|string|直播间号||
|usid|true|string|用户唯一标识||

##### 返回结果

1. 如果最外层code为00000 ,表示通讯成功,此时的data数据有两种情况
2. 第一种:data中的code为60005,表示该直播间的直播已经结束,对应的list为随机推荐的直播间
3. 第二种:data中没有code,表示获取数据正常,返回数据信息
4. 如果最外层的code不为00000,表示请求过程中发生错误,可通过对应的message查询信息

```
<<<
success
{
    "code":"00000",
    "data":{
        "playurls":{
            "rtmp":"rtmp://pili-live-rtmp.zhibocloud.cn/zhibo_test/zhibocloud_uid_4",
            "hls":"http://10000ed.live1-hls.z1.pili.qiniucdn.com/zhibo_test/zhibocloud_uid_4.m3u8",
            "httpflv":"http://10000ed.live1-hdl.z1.pili.qiniucdn.com/zhibo_test/zhibocloud_uid_4.flv"
        },
        "im":{
            "cid":10087,
            "im_uid":20004
        },
        "user":{
            "usid":"zbuser_7"
        }
    }
}
<<<
success
{
    "code":"00000",
    "data":{
        "code":"60005",
        "message":"直播已结束",
        "list":[
            {
                "stream":{
                    "id":"z1.zhibo_test.zhibocloud_uid_4",
                    "title":"我在直播",
                    "location":"",
                    "icon":{
                        "0":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/1676408d0fd7659e08c7539444a389ce.jpg",
                        "1":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/thumb/1676408d0fd7659e08c7539444a389ce_t.jpg",
                    },
                    "online_count":0
                },
                "im":{
                    "cid":10087,
                    "im_uid":20004
                },
                "user":{
                    "usid":"zbuser_7"
                }
            }
        ],
        "view_count":100
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表


######情况一
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  playurls  |  object | 播放的地址   | 包含多个可播放的地址 |
|{im}   |  object     |       im相关信息      |                            |
|cid    |  int        |       会话ID          |代表聊天室ID                |
|im_uid   |  int        |       会话创建者的im_uid        ||
* * * * *

#######情况二:
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|view_count| int| 主播最近一次直播的观看人数||
|{stream}|
|       id          |       string          |       直播间ID          |  |
|       title       |       string          |       直播间标题          |  |
|       location    |       string          |       主播所在地址          |  |
|       online_count|       int             |       在线人数          |  |
|       icon        |       string          |       直播间封面图          |  |
|{user}|
|       uid         |       string          |       主播加密后的UID          |  |
|       uname       |       string          |       主播的昵称          |  |
|       is_verified |       int             |       主播是否认证       | 1:已认证 0:未认证 |
|       avatar      |       string          |       主播的头像          |  |

---
#### 5.1.2 随机推荐直播间列表(`ZBCloud_Get_Randlive_List`)
在主播结束直播后，可以通过调用本接口来获取推荐列表。

##### 请求参数说明:
* 参数中的stream_uid为可选参数,如果传入此参数,将返回该主播的最近一次直播的浏览人数,如果不传参数,将没有该统计人数字段返回
* 随机推荐的主播,如果不指定count参数,目前最多为4个

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|stream_uid|true|string|当前直播间主播的UID||
|count|false|int|获取的个数|default:4|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "stream":{
                "id":"z1.zhibo_test.zhibocloud_uid_4",
                "title":"我在直播",
                "location":"",
                "icon":{
                    "0":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/1676408d0fd7659e08c7539444a389ce.jpg",
                    "1":"http://my.zhibocloud.com/public/uploads/2016-08-01/images/thumb/1676408d0fd7659e08c7539444a389ce_t.jpg",
                    "更多":"更多比例的图片"
                },
                "online_count":5
            },
            "im":{
                "cid":10087,
                "im_uid":20004
            },
            "user":{
                "usid":"zbuser_7"
            }
        }
    ]
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|{stream}|
|       id          |       string          |       直播间ID          |  |
|       title       |       string          |       直播间标题          |  |
|       location    |       string          |       主播所在地址          |  |
|       online_count|       int             |       在线人数          |  |
|       icon        |       object          |       直播间封面图          |  |
|{im}|
|cid    |  int        |       会话ID          |代表聊天室ID                |
|im_uid   |  int        |       会话创建者的im_uid        ||
|{user}|
|       usid        |       string          |       用户唯一标识          |  |

#### 5.1.3 使用H5观看直播(`ZBCloud_Show_Stream`）

##### 请求参数说明:
播放的视频目前为自动适应手机屏幕尺寸并全屏播放

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||

##### 返回结果

```
跳转至html5页面

```

---
### 5.2 点赞
#### 统计点赞数据(`ZBCloud_Give_Zan`)
本接口将的登录用户在观看直播时的点赞信息发给服务器进行统计。
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||
|count|true|int|赞总数||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "message":"处理成功"
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```


---
### 5.3 聊天
#### 发起群聊(`ZBCloud_Im_Conversation_Create`)
##### 请求参数说明:
###### usids参数
* 此处的usids参数代表的是需要和谁发起群聊,可以是一个或者多个(多个用户的时候以逗号分割),当然也可以为空,为空的时候表示只创建群,否则会默认添加指定的用户到群聊中

###### name参数
* name参数代表的是创建群聊的名字,32个字节以内,默认为空

###### pwd参数
* pwd参数代表的是他人加入该群聊的时候,需要输入的密码,32个字节以内,默认为空,为空表示没有密码,任何人都可以加入

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|type|true|int|聊天类型|0:私聊  1:群聊|
|name|false|string|群聊的名字||
|usids|false|string|参与群聊的用户标识||
|pwd|false|string|该群聊的加入密码,默认为空||

##### 返回结果

```
<<<
success
{
    "code": "00000",
    "data": {
        "cid": 18,
        "im_uid": 20004,
        "name": "都来群聊啦",
        "max_count": 0,
        "pwd": "951024",
        "mc": 2
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|cid    |  int        |       会话ID          |代表群聊的会话ID                |
|im_uid   |  int        |       会话创建者的im_uid        || 
|name   |  string        |       创建的群聊名称        ||
|max_count   |  int        |       最大可加入成员数量        |0:表示不限制|
|pwd   |  string        |       加入群聊的密码        |空表示不需要密码|
|mc   |  int        |       当前群聊中的人数        ||


---
### 5.4 礼物（观众端）
#### 5.4.1 <font style = 'color:red'>赠送主播礼物(`ZBCloud_Give_Gift`)</font>
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||
|gift_code|true|string|礼物代号|通过配置获取礼物列表|
|count|true|int|赠送多少个同代号的礼物||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "message":"赠送成功"
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

---
#### 5.4.2 赠送礼物排行榜(`ZBCloud_Gift_TopList`)
本接口获取的是某主播收到用户赠送礼物的排序
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||
|p|false|int|分页页数||
|limit|false|int|每页显示数量||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "user":{
                "usid":"zbuser_7",
                "gold":15
            }
        },
    ]
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}


```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|   usid          |       string          |       用户唯一标识          ||
|   gold          |        int            |       送出的金币数量          ||

--
### 5.5 投票
#### 5.5.1 发起投票(`ZBCloud_Apps_Vote_Create`)
##### 请求参数说明:
★  options参数说明

* 为了支持可扩展性,本字段不限制可选项数目,但至少为两个可选项.
* 参数组合方式为

~~~
选项key:选项名称
~~~
* 如果不指定选项key,系统会自动生成选项key
* 多个选项以逗号分割,如

~~~
选项key1:选项名称1,选项key2:选项名称2
~~~
★  time参数说明
* time参数表示的是本次投票的持续时间,单位:分钟 
* 当参数为0时,表示永久有效,即任何时候都可以进行投票
* 该参数仅支持整型


| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|options|true|string|本次投票的可选项,请参阅说明||
|time|false|int|本次投票的持续时间|0表示永久有效 default:0|
|title|false|string|发起本次投票的项目名称||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-QjSk10apIfSjvewrd",
        "create_time":"1471245256",
        "title":"",
        "time":0,
        "ballot":0,
        "status":1,
        "options":[
            {
                "option_key":"op_4",
                "option_value":"选项1",
                "option_ballot":0
            },
            {
                "option_key":"op_5",
                "option_value":"选项2",
                "option_ballot":0
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |


#### 5.5.2 <font style = 'color:green'>投票(`ZBCloud_Apps_Vote_Poll`)</font>
##### 请求参数说明:
* oper_token参数

该参数为是加密的口令

参数加密方法:

1. 该口令由两部分组成:  投票信息的MD5字符串加密+投票数量
2. 第一部分:由投票项目标识(vote_id)+所投选项key(option_key)组成的字符串经过MD5加密所得
3. 第二部分:'n'+投票数量
4. 例如: 给标识为vote_id为test1的项目A选项投100票,所得的oper_token计算方法为
 ①第一部分:MD5(test1A) = ab7b671eabbf74fadb1d7a1f139305aa
 ②第二部分:n100
 ③得到的oper_token为:
<font color="blue">ab7b671eabbf74fadb1d7a1f139305aa</font><font color="red">n100</font>
5. 如果投票的数量参数为0或者不是整数,将不会真正的投票,直接返回当前投票的信息

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||
|option_key|true|string|所投选项key||
|oper_token|true|string|投票口令||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":1,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |


#### 5.5.3 <font/ style='color:green'>获取投票的最新信息(`ZBCloud_Apps_Vote_GetInfo`)</font>
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":1,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |


#### 5.5.4 获取用户最后发起的投票(`ZBCloud_Apps_Vote_GetUserLastVote`)
##### 请求参数说明:
如果传入了usid参数,表示获取指定用户最后发起的投票,不传表示获取当前请求用户最后发起的投票

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-uUgKrGL3EUwH9FdOV",
        "create_time":"1471245256",
        "title":"",
        "time":0,
        "ballot":0,
        "status":1,
        "options":[
            {
                "option_key":"op_4",
                "option_value":"选项1",
                "option_ballot":0
            },
            {
                "option_key":"op_5",
                "option_value":"选项2",
                "option_ballot":0
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |

#### 5.5.5 永久结束投票(`ZBCloud_Apps_Vote_EndPoll`)
##### 请求参数说明:

* 本接口仅创建投票的用户请求才会结束,否则将返回错误信息
* 该操作不可逆,一旦结束无法恢复,如果只是想暂时关闭投票,请查看 [临时关闭投票](http://www.kancloud.cn/martin_sun/zhibocloud/194526)

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":0,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |

#### 5.5.6 临时关闭投票(`ZBCloud_Apps_Vote_EndPollTemp`)
##### 请求参数说明:
* 本接口仅创建投票的用户请求才会有权限操作,否则将返回错误信息

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":2,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |

#### 5.5.7 恢复临时关闭的投票(`ZBCloud_Apps_Vote_StartPollTemp`)
* 本接口仅创建投票的用户请求才会有权限操作,否则将返回错误信息

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":1,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |
#### 5.5.8 设置投票时间 (`ZBCloud_Apps_Vote_SetTime`)

##### 请求参数说明:
★  time参数说明
* 修改的时间是在原持续时间上进行延长或者缩短,正数表示延长,负数表示缩短,单位:分钟
* 当参数为0时,表示永久有效,即任何时候都可以进行投票
* 如果time参数为负数,此时如果原持续时间小于或者等于设置的时间,将不会进行任何操作
* 该参数仅支持整型,非法参数将不会进行任何操作

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||
|time|true|int|本次投票的持续时间||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-QjSk10apIfSjvewrd",
        "create_time":"1471245256",
        "title":"",
        "time":0,
        "ballot":0,
        "status":1,
        "options":[
            {
                "option_key":"op_4",
                "option_value":"选项1",
                "option_ballot":0
            },
            {
                "option_key":"op_5",
                "option_value":"选项2",
                "option_ballot":0
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |

--


## 6  其他接口
### 6.1 <font style = 'color:red'>获取用户信息(`ZB_User_Get_Info`)</font>

##### 请求参数说明:
★  如果获取多个用户的信息,使用英文逗号分割user_id参数

★  如果user参数为空或不传,会返回当前登陆用户的信息

★  为了数据统一,获取单个用户信息,也会以二维数组数据传递


| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Get_Info `|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|usid|true|string|用户唯一标识||
| field |false|string|获取指定的字段,多个以逗号分割 | |


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "uid":"iyn=0t5P2wUwmq",
            "uname":"小孙test",
            "sex":1,
            "intro":"这是一个牛逼的人",
            "cover":{

            },
            "location":"",
            "avatar":{

            },
            "is_verified":0,
            "usid":"zbuser_7",
            "gold":364,
            "follow_count":0,
            "fans_count":1,
            "zan_count":8803,
             "is_follow": 1
        }
    ]
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       uid         |       string          |       加密后的用户UID          |  |
|       usid        |       string          |       储存在直播服务器端的用户唯一标识||
|       uname       |       string          |       用户昵称                 ||
|       sex         |       int             |       性别                     |1:男 2:女|
|       intro       |       string          |       简介                     ||
|       location    |       string          |       用户填写的地址信息       ||
|   cover            |       object          |       用户个人主页封面图地址             ||
|   avatar          |       object          |       用户头像地址             ||
|   is_verified     |       int             |       是否已经认证           |0:未认证 1:已认证 2:审核中|
|   gold            |       int             |       金币数                   ||
|   follow_count    |       int             |       关注数                   ||
|   fans_count      |       int             |       粉丝数                   ||
|   zan_count      |       int             |       收到的赞数                   ||
|   is_follow      |       int             |       是否关注                   ||
---
### 6.2 <font style = 'color:red'>关注操作(`ZB_User_Follow`)</font>

##### 请求参数说明:

###### 请求方式 Post
##### BasicURL：http://custom.zhibocloud.cn/api

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Follow`|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|user_id|true|string|指定用户的列表信息||
|action|false|int|操作| 1:关注 2:取消关注 3:查询是否关注 default:3|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "is_follow":1
    }
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       is_follow         |       int          |       是否已经关注          | 1:关注成功/已关注 0:未关注  |
--
