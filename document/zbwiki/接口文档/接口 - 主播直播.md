# 接口 - 主播直播

## 概述
主播直播的过程大致分为 3 个模块：发起直播，正在直播，结束直播。

####1.发起直播

直播编辑接口有：`创建直播间`、`校验直播间`、`开始推流准备`、上传直播封面。

####2.正在直播
正在直播接口有：`礼物排行榜`、`发起群聊`、`投票`、`禁言`。

####3.结束直播
直播结束页的接口有：`断开推流`。

#####本文档分为 4 个章节，分别为 ：

* 1 发起直播接口
###### 1.1 [创建直播间](#1.1 创建直播间)
###### 1.2 [校验直播间](#1.2 校验直播间)
###### 1.3 [开始推流准备](#1.3 开始推流准备)
###### 1.4 [上传直播封面](#1.4上传直播封面)

* 2 正在直播接口
###### 2.1 [赠送礼物排行榜](#2.1 赠送礼物排行榜)
###### 2.2 [发起群聊](#2.2 发起群聊)
###### 2.3 投票
###### 2.3.1 [发起投票](#2.3.1 发起投票)
###### 2.3.2 [投票](#2.3.2 投票)
###### 2.3.3 [获取投票的最新状态](#2.3.3 获取投票的最新状态)
###### 2.3.4 [获取用户最后发起的投票](#2.3.4 获取用户最后发起的投票)
###### 2.3.5 [永久结束投票](#2.3.5 永久结束投票)
###### 2.3.6 [临时关闭投票](#2.3.6 临时关闭投票)
###### 2.3.7 [恢复临时关闭的投票](#2.3.7 恢复临时关闭的投票)
###### 2.3.8 [设置投票时间](#2.3.8 设置投票时间)
###### 2.4 禁言
###### 2.4.1 [查询用户禁言状态](#2.4.1 查询用户禁言状态)
###### 2.4.2 [禁言用户](#2.4.2 禁言用户)
###### 2.4.3 [解除禁言](#2.4.3 解除禁言)
###### 2.4.4 [查看被禁言的列表](#2.4.4 查看被禁言的列表)
###### 2.5 获取用户信息
###### 2.6 关注操作

* 3 结束直播接口
###### [断开推流](#断开推流)

* 4 其他接口
###### [查询用户信息](#)
###### [关注操作](#)


## 1 发起直播接口

### 1.1 创建直播间(` ZBCloud_Create_Stream `)
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|false|string|用户唯一标识||
##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "id":"z1.zhibo_test.zhibocloud_uid_4",
        "im":{
            "cid":10087,
            "im_uid":10004
        }
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```
##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
| id    |  string     |       创建的stream_id |                            |
|{im}   |  object     |       im相关信息      |                            |
|cid    |  int        |       会话ID          |代表聊天室ID                |
|im_uid   |  int        |       会话创建者的im_uid        ||
---
### 1.2 校验直播间(` ZBCloud_Check_Stream `)
##### 请求参数说明:
★  本接口请采用POST请求,不支持其他方式
★  接口为创建直播间之后对直播间的有效性进行检测
★  参数中的stream_id加密方法:
    MD5方式加密
    
1. 最外层code值为00000,返回数据中data有两种状态:
2. 第一种data数据中的code为60000,表示该用户已被禁止直播,对应的time为禁播的截止日期
3. 第二种data数据中不存在code,表示通过校验,data中返回的数据为所需要的数据
4. 如果请求过程中,最外层code值不为00000 表示请求过程中出现错误,可通过message查看信息
    
| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|stream_id|true|string|直播间的stream_id|(MD5加密)|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        'stream':"{
            "id":"z1.zhibo_test.zhibo_uid_22",
            "createdAt":"2016-04-08T15:05:43.689+08:00",
            "updatedAt":"2016-04-08T15:05:43.689+08:00",
            "title":"zhibo_uid_22",
            "hub":"zhibo_test",
            "disabledTill":0,
            "disabled":false,
            "publishKey":"1f0b3426-c781-47d4-90ec-60b077b7608a",
            "publishSecurity":"dynamic",
            "hosts":{
                "publish":{
                    "rtmp":"pili-publish.zhibocloud.cn"
                },
                "live":{
                    "hdl":"10000ed.live1-hdl.z1.pili.qiniucdn.com",
                    "hls":"10000ed.live1-hls.z1.pili.qiniucdn.com",
                    "http":"10000ed.live1-hls.z1.pili.qiniucdn.com",
                    "rtmp":"pili-live-rtmp.zhibocloud.cn"
                },
                "playback":{
                    "hls":"10000ed.playback1.z1.pili.qiniucdn.com",
                    "http":"10000ed.playback1.z1.pili.qiniucdn.com"
                },
                "play":{
                    "http":"10000ed.live1-hls.z1.pili.qiniucdn.com",
                    "rtmp":"pili-live-rtmp.zhibocloud.cn"
                }
            }
        }"
    }
}
<<<
success
{
     "code":"00000",
     "data":{
        "code":"60000",
        "message":"已被禁止直播",
        "time":"2016年05月1日 23时:59分"
     }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       stream         |       string          |       stream字符串数据包          |  |
|       message        |       string          |        文字提示信息               |  |
|       time           |       string          |        禁播的截止日期             |如果被禁播,这里会返回time字段|
|      share           |        string         |        分享数据                |如果校验通过,会返回所需要的分享数据|
|...|...|...|更多|
---
### 1.3 开始推流准备(` ZBCloud_Start_Stream `)
##### 请求参数说明:

★  本接口仅在直播间验证通过后才能使用,否则将返回错误信息
★  本接口返回数据中的data类型为string,供直接使用

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|title|false|string|设置的直播间title||
|location|false|string|GPS的经纬度坐标|格式:'lat纬度,lng经度'|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":"{
            "id":"z1.zhibo_test.zhibo_uid_22",
            "createdAt":"2016-04-08T15:05:43.689+08:00",
            "updatedAt":"2016-04-08T15:05:43.689+08:00",
            "title":"zhibo_uid_22",
            "hub":"zhibo_test",
            "disabledTill":0,
            "disabled":false,
            "publishKey":"1f0b3426-c781-47d4-90ec-60b077b7608a",
            "publishSecurity":"dynamic",
            "hosts":{
                "publish":{
                    "rtmp":"pili-publish.zhibocloud.cn"
                },
                "live":{
                    "hdl":"10000ed.live1-hdl.z1.pili.qiniucdn.com",
                    "hls":"10000ed.live1-hls.z1.pili.qiniucdn.com",
                    "http":"10000ed.live1-hls.z1.pili.qiniucdn.com",
                    "rtmp":"pili-live-rtmp.zhibocloud.cn"
                },
                "playback":{
                    "hls":"10000ed.playback1.z1.pili.qiniucdn.com",
                    "http":"10000ed.playback1.z1.pili.qiniucdn.com"
                },
                "play":{
                    "http":"10000ed.live1-hls.z1.pili.qiniucdn.com",
                    "rtmp":"pili-live-rtmp.zhibocloud.cn"
                }
            }
        }"
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       data           |       string          |       stream字符串数据包          |  |

### 1.4 上传直播封面(`ZBCloud_Upload_Stream`)
##### 请求参数说明:

★  返回参数中的urls第一张为上传的原图,其他为生成的缩略图地址

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|thumb|false|string|自定义生成的缩略图大小||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "attach_id":"iLl-3aAnPPVtTv",
            "attach_type":"stream",
            "urls":{
                "0":"http://host/images/67f244481ee9a7b8990e5dcbe7b19ac4.jpg",
                "a":"http://host/images/thumb/67f244481ee9a7b8990e5dcbe7b19ac4_a.jpg",
                "b":"http://host/images/thumb/67f244481ee9a7b8990e5dcbe7b19ac4_b.jpg",
                "c":"http://host/images/thumb/67f244481ee9a7b8990e5dcbe7b19ac4_c.jpg",
                "d":"http://host/images/thumb/67f244481ee9a7b8990e5dcbe7b19ac4_d.jpg",
                "e":"http://host/images/thumb/67f244481ee9a7b8990e5dcbe7b19ac4_e.jpg",
                "20x20":"http://host/images/thumb/67f244481ee9a7b8990e5dcbe7b19ac4_20x20.jpg"
            }
        }
    ]
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|   attach_id     |       string          |       加密后的附件ID          ||
|   attach_type   |       string          |       上传的附件类型          ||
|   urls          |       object          |       附件的所有地址          ||

--
## 2 正在直播接口
### 2.1 赠送礼物排行榜(`ZBCloud_Gift_TopList`)
本接口获取的是某主播收到用户赠送礼物的排序
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||
|p|false|int|分页页数||
|limit|false|int|每页显示数量||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "user":{
                "usid":"zbuser_7",
                "gold":15
            }
        },
    ]
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}


```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|   usid          |       string          |       用户唯一标识          ||
|   gold          |        int            |       送出的金币数量          ||


---
### 2.2 发起群聊(`ZBCloud_Im_Conversation_Create`)
##### 请求参数说明:
###### usids参数
* 此处的usids参数代表的是需要和谁发起群聊,可以是一个或者多个(多个用户的时候以逗号分割),当然也可以为空,为空的时候表示只创建群,否则会默认添加指定的用户到群聊中

###### name参数
* name参数代表的是创建群聊的名字,32个字节以内,默认为空

###### pwd参数
* pwd参数代表的是他人加入该群聊的时候,需要输入的密码,32个字节以内,默认为空,为空表示没有密码,任何人都可以加入

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|type|true|int|聊天类型|0:私聊  1:群聊|
|name|false|string|群聊的名字||
|usids|false|string|参与群聊的用户标识||
|pwd|false|string|该群聊的加入密码,默认为空||

##### 返回结果

```
<<<
success
{
    "code": "00000",
    "data": {
        "cid": 18,
        "im_uid": 20004,
        "name": "都来群聊啦",
        "max_count": 0,
        "pwd": "951024",
        "mc": 2
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|cid    |  int        |       会话ID          |代表群聊的会话ID                |
|im_uid   |  int        |       会话创建者的im_uid        || 
|name   |  string        |       创建的群聊名称        ||
|max_count   |  int        |       最大可加入成员数量        |0:表示不限制|
|pwd   |  string        |       加入群聊的密码        |空表示不需要密码|
|mc   |  int        |       当前群聊中的人数        ||



---
### 2.3 投票
#### 2.3.1 发起投票(`ZBCloud_Apps_Vote_Create`)
##### 请求参数说明:
★  options参数说明

* 为了支持可扩展性,本字段不限制可选项数目,但至少为两个可选项.
* 参数组合方式为

~~~
选项key:选项名称
~~~
* 如果不指定选项key,系统会自动生成选项key
* 多个选项以逗号分割,如

~~~
选项key1:选项名称1,选项key2:选项名称2
~~~
★  time参数说明
* time参数表示的是本次投票的持续时间,单位:分钟 
* 当参数为0时,表示永久有效,即任何时候都可以进行投票
* 该参数仅支持整型


| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|options|true|string|本次投票的可选项,请参阅说明||
|time|false|int|本次投票的持续时间|0表示永久有效 default:0|
|title|false|string|发起本次投票的项目名称||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-QjSk10apIfSjvewrd",
        "create_time":"1471245256",
        "title":"",
        "time":0,
        "ballot":0,
        "status":1,
        "options":[
            {
                "option_key":"op_4",
                "option_value":"选项1",
                "option_ballot":0
            },
            {
                "option_key":"op_5",
                "option_value":"选项2",
                "option_ballot":0
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |


#### 2.3.2 <font style = 'color:green'>投票(`ZBCloud_Apps_Vote_Poll`)</font>
##### 请求参数说明:
* oper_token参数

该参数为是加密的口令

参数加密方法:

1. 该口令由两部分组成:  投票信息的MD5字符串加密+投票数量
2. 第一部分:由投票项目标识(vote_id)+所投选项key(option_key)组成的字符串经过MD5加密所得
3. 第二部分:'n'+投票数量
4. 例如: 给标识为vote_id为test1的项目A选项投100票,所得的oper_token计算方法为
 ①第一部分:MD5(test1A) = ab7b671eabbf74fadb1d7a1f139305aa
 ②第二部分:n100
 ③得到的oper_token为:
<font color="blue">ab7b671eabbf74fadb1d7a1f139305aa</font><font color="red">n100</font>
5. 如果投票的数量参数为0或者不是整数,将不会真正的投票,直接返回当前投票的信息

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||
|option_key|true|string|所投选项key||
|oper_token|true|string|投票口令||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":1,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |


#### 2.3.3 <font/ style='color:green'>获取投票的最新信息(`ZBCloud_Apps_Vote_GetInfo`)</font>
##### 请求参数说明:

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":1,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |


#### 2.3.4 获取用户最后发起的投票(`ZBCloud_Apps_Vote_GetUserLastVote`)
##### 请求参数说明:
如果传入了usid参数,表示获取指定用户最后发起的投票,不传表示获取当前请求用户最后发起的投票

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-uUgKrGL3EUwH9FdOV",
        "create_time":"1471245256",
        "title":"",
        "time":0,
        "ballot":0,
        "status":1,
        "options":[
            {
                "option_key":"op_4",
                "option_value":"选项1",
                "option_ballot":0
            },
            {
                "option_key":"op_5",
                "option_value":"选项2",
                "option_ballot":0
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |

#### 2.3.5 永久结束投票(`ZBCloud_Apps_Vote_EndPoll`)
##### 请求参数说明:

* 本接口仅创建投票的用户请求才会结束,否则将返回错误信息
* 该操作不可逆,一旦结束无法恢复,如果只是想暂时关闭投票,请查看 [临时关闭投票](http://www.kancloud.cn/martin_sun/zhibocloud/194526)

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":0,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |

#### 2.3.6 临时关闭投票(`ZBCloud_Apps_Vote_EndPollTemp`)
##### 请求参数说明:
* 本接口仅创建投票的用户请求才会有权限操作,否则将返回错误信息

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":2,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |

#### 2.3.7 恢复临时关闭的投票(`ZBCloud_Apps_Vote_StartPollTemp`)
* 本接口仅创建投票的用户请求才会有权限操作,否则将返回错误信息

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-qT3ZBDHZESsQmSonE",
        "create_time":"1471230882",
        "title":"",
        "time":0,
        "ballot":89,
        "status":1,
        "options":[
            {
                "option_key":"op_1",
                "option_value":"选项1",
                "option_ballot":15
            },
            {
                "option_key":"op_2",
                "option_value":"选项2",
                "option_ballot":74
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |
#### 2.3.8 设置投票时间 (`ZBCloud_Apps_Vote_SetTime`)

##### 请求参数说明:
★  time参数说明
* 修改的时间是在原持续时间上进行延长或者缩短,正数表示延长,负数表示缩短,单位:分钟
* 当参数为0时,表示永久有效,即任何时候都可以进行投票
* 如果time参数为负数,此时如果原持续时间小于或者等于设置的时间,将不会进行任何操作
* 该参数仅支持整型,非法参数将不会进行任何操作

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|vote_id|true|string|投票项目标识||
|time|true|int|本次投票的持续时间||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "vote_id":"v-QjSk10apIfSjvewrd",
        "create_time":"1471245256",
        "title":"",
        "time":0,
        "ballot":0,
        "status":1,
        "options":[
            {
                "option_key":"op_4",
                "option_value":"选项1",
                "option_ballot":0
            },
            {
                "option_key":"op_5",
                "option_value":"选项2",
                "option_ballot":0
            }
        ]
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|  vote_id           | string |      创建的投票项目标识|该标识已经采用动态加密  |
|  create_time       | string |      创建时间          |  时间戳|
|  title             | string |      创建的投票项目名称|  |
|  time              | int    |      投票持续时间      |  单位:分钟|
|  ballot            | int    |      投票的总票数      |  |
|  status            | int    |      投票项目状态      |1:正在投票 2:投票临时关闭 0:投票结束 |
|  options           | array  |      包含所有的投票选项|  |
|  option_key        | string |      投票选项key       |  |
|  option_value      | string |      投票选项name      |  |
|  option_ballot     | int    |      投票数            |  |
---
### 2.4 禁言
#### 2.4.1 查询用户禁言状态(`ZBCloud_Im_Stream_status`)

##### 请求参数说明:
★  本接口仅支持POST请求
<font color="red">★  需要注意:禁言设置长期有效!!!</font>

★  接口仅限主播使用

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "im_status":1,
        "expire":1474286014
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|   im_status            |       int             |      在当前直播间是否被禁言                   |1:已被禁言 0:未被禁言 |
|   expire      |       int             |       如果被禁言,代表禁言的截止时间戳                   |0:表示永久禁言|
#### 2.4.2 禁言用户(`ZBCloud_Im_Stream_Disable`)
##### 请求参数说明:

★  本接口仅支持POST请求

★  建议禁言时长设置为120分钟,即在当前时间戳上+7200  (单位:秒)

★  本接口返回没有data数据,如果操作成功返回code为00000,其他均为操作失败
<font color="red">★  需要注意:禁言设置长期有效!!!</font>

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|用户唯一标识||
|time|false|int|禁言时长|0表示永久,其他视为过期时间戳,default:0|


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "message":"禁言成功"
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}

```

#### 2.4.3 解除禁言(`ZBCloud_Im_Stream_Enable`)


##### 请求参数说明:
★  本接口仅支持POST请求

★  本接口返回没有data数据,如果操作成功返回code为00000,其他均为操作失败
<font color="red">★  需要注意:禁言设置长期有效!!!</font>

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|usid|true|string|需要解除禁言的用户标识||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "message":"？？？"
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

#### 2.4.4 查看被禁言的列表(ZBCloud_Shutup_List)

##### 请求参数说明:
★  本接口暂时为测试用的接口

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|cid|true|int|需要查询的聊天会话ID||


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        //被禁言的IM用户UID列表
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

---
###2.5 <font style = 'color:red'>获取用户信息(`ZB_User_Get_Info`)</font>

##### 请求参数说明:
★  如果获取多个用户的信息,使用英文逗号分割user_id参数

★  如果user参数为空或不传,会返回当前登陆用户的信息

★  为了数据统一,获取单个用户信息,也会以二维数组数据传递


| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Get_Info `|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|usid|true|string|用户唯一标识||
| field |false|string|获取指定的字段,多个以逗号分割 | |


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "uid":"iyn=0t5P2wUwmq",
            "uname":"小孙test",
            "sex":1,
            "intro":"这是一个牛逼的人",
            "cover":{

            },
            "location":"",
            "avatar":{

            },
            "is_verified":0,
            "usid":"zbuser_7",
            "gold":364,
            "follow_count":0,
            "fans_count":1,
            "zan_count":8803,
             "is_follow": 1
        }
    ]
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       uid         |       string          |       加密后的用户UID          |  |
|       usid        |       string          |       储存在直播服务器端的用户唯一标识||
|       uname       |       string          |       用户昵称                 ||
|       sex         |       int             |       性别                     |1:男 2:女|
|       intro       |       string          |       简介                     ||
|       location    |       string          |       用户填写的地址信息       ||
|   cover            |       object          |       用户个人主页封面图地址             ||
|   avatar          |       object          |       用户头像地址             ||
|   is_verified     |       int             |       是否已经认证           |0:未认证 1:已认证 2:审核中|
|   gold            |       int             |       金币数                   ||
|   follow_count    |       int             |       关注数                   ||
|   fans_count      |       int             |       粉丝数                   ||
|   zan_count      |       int             |       收到的赞数                   ||
|   is_follow      |       int             |       是否关注                   ||
---
### 2.6 <font style = 'color:red'>关注操作(`ZB_User_Follow`)</font>

##### 请求参数说明:

###### 请求方式 Post
##### BasicURL：http://custom.zhibocloud.cn/api

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Follow`|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|user_id|true|string|指定用户的列表信息||
|action|false|int|操作| 1:关注 2:取消关注 3:查询是否关注 default:3|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "is_follow":1
    }
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       is_follow         |       int          |       是否已经关注          | 1:关注成功/已关注 0:未关注  |


--
## 直播结束接口
### 断开推流(`ZBCloud_End_Stream`)
##### 请求参数说明:
★  参数中的stream_id通过MD5加密


| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|stream_id|true|string|stream_id|MD5加密|


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "gold":0,
        "zan_count":0,
        "view_count":0
    }
}
<<<
error
{
    "code":"错误代码",
    "message":"错误信息文字描述"
}
```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|   gold            |       int             |       本次直播获得的金币数                   ||
|   view_count      |       int             |       本次直播房间在线人数                   ||
|   zan_count       |       int             |       本次直播获得的赞总数                   ||

## 4  其他接口
### 4.1 <font style = 'color:red'>获取用户信息(`ZB_User_Get_Info`)</font>

##### 请求参数说明:
★  如果获取多个用户的信息,使用英文逗号分割user_id参数

★  如果user参数为空或不传,会返回当前登陆用户的信息

★  为了数据统一,获取单个用户信息,也会以二维数组数据传递


| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Get_Info `|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|usid|true|string|用户唯一标识||
| field |false|string|获取指定的字段,多个以逗号分割 | |


##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":[
        {
            "uid":"iyn=0t5P2wUwmq",
            "uname":"小孙test",
            "sex":1,
            "intro":"这是一个牛逼的人",
            "cover":{

            },
            "location":"",
            "avatar":{

            },
            "is_verified":0,
            "usid":"zbuser_7",
            "gold":364,
            "follow_count":0,
            "fans_count":1,
            "zan_count":8803,
             "is_follow": 1
        }
    ]
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       uid         |       string          |       加密后的用户UID          |  |
|       usid        |       string          |       储存在直播服务器端的用户唯一标识||
|       uname       |       string          |       用户昵称                 ||
|       sex         |       int             |       性别                     |1:男 2:女|
|       intro       |       string          |       简介                     ||
|       location    |       string          |       用户填写的地址信息       ||
|   cover            |       object          |       用户个人主页封面图地址             ||
|   avatar          |       object          |       用户头像地址             ||
|   is_verified     |       int             |       是否已经认证           |0:未认证 1:已认证 2:审核中|
|   gold            |       int             |       金币数                   ||
|   follow_count    |       int             |       关注数                   ||
|   fans_count      |       int             |       粉丝数                   ||
|   zan_count      |       int             |       收到的赞数                   ||
|   is_follow      |       int             |       是否关注                   ||
---
### 4.2 <font style = 'color:red'>关注操作(`ZB_User_Follow`)</font>

##### 请求参数说明:

###### 请求方式 Post
##### BasicURL：http://custom.zhibocloud.cn/api

| 参数| 必选 | 类型 | 说明 | 备注 |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|api|true|string|接口名称| api = `ZB_User_Follow`|
|auth_accesskey|true|string|授权accesskey ||
|auth_secretkey|true|string|授权secretkey||
|user_id|true|string|指定用户的列表信息||
|action|false|int|操作| 1:关注 2:取消关注 3:查询是否关注 default:3|

##### 返回结果

```
<<<
success
{
    "code":"00000",
    "data":{
        "is_follow":1
    }
}
<<<
error
{
 "code":"错误代码",
  "message":"错误提示信息"
}

```

##### 返回字段对照表
| 字段 | 类型 | 中文描述 |附加信息|
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
|       is_follow         |       int          |       是否已经关注          | 1:关注成功/已关注 0:未关注  |
--
